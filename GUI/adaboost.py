import numpy as np
import tkinter as tk
from PIL import Image, ImageTk
import pickle

class Adaboost:

	def __init__(self,root,input,faces,_relx,_relwidth,_rely,_relheight,_anchor):
	        self.root=root
	        self._relx=_relx
	        self._relwidth=_relwidth
	        self._relheight=_relheight
	        self._rely=_rely
	        self._anchor=_anchor
	        self.show()
	        self.input=input
	        self.faces=faces

	def show(self):
		self.frame=tk.Frame(self.root,bg='#ffc180',bd=5)
		self.frame.place(relx=self._relx,relwidth=self._relwidth,rely=self._rely,relheight=self._relheight,anchor=self._anchor)

		label=tk.Label(self.frame,text = 'Adaboost')
		label.pack()

		button=tk.Button(self.frame,text="Run Model",command=self.Run_model)
		button.place(relx=1,rely=1,width=100,height=60,anchor='se')



	def Run_model(self):
		faces=self.input.get_faces_grayscale()
        pkl_filename = "adaboost_model_n_100_r_1.pkl"
        with self.open(pkl_filename, 'rb') as file:
            pickle_model = self.pickle.load(file)
		
        # Shape muss in DF (n,2304)
		# predictions=[self.model.predict(faces.reshape(np.shape(faces)[0],48,48,1))]

		emotions=["Angry","Disgust","Fear","Happy","Sad","Surprise","Neutral"]
        
        predictions=self.pickle_model.predict([[254,254,254,254,254,249,255,160,2,58,53,70,77,76,75,78,68,18,32,29,0,54,73,75,72,68,75,77,76,76,75,80,51,36,47,40,44,42,37,48,40,64,54,54,86,16,0,161,254,254,254,254,254,248,255,120,2,38,50,47,76,76,83,63,51,142,174,159,88,59,48,67,37,61,46,77,77,75,74,85,19,54,81,73,50,49,53,72,45,41,66,53,70,17,0,122,254,254,254,254,253,253,250,61,17,52,34,34,76,79,68,50,129,235,214,219,226,215,183,116,127,218,93,43,79,80,74,79,57,40,73,30,77,64,49,83,65,38,70,57,72,26,0,114,254,254,254,254,252,255,231,53,17,61,8,2,76,61,21,125,226,207,208,209,206,213,217,226,224,218,214,96,36,67,79,78,51,37,76,7,71,37,51,82,56,59,84,79,82,59,2,74,254,254,254,254,252,255,223,47,16,83,59,54,77,37,127,226,208,211,210,211,212,210,209,207,206,207,216,216,80,24,80,76,64,54,66,3,68,22,58,54,40,83,61,64,65,52,2,96,254,254,254,254,250,255,185,19,25,62,77,80,48,83,228,208,210,213,212,210,211,212,213,213,211,213,208,215,216,88,47,86,69,82,45,18,80,36,38,2,34,53,39,41,40,48,2,124,254,254,254,254,250,255,173,11,30,45,74,75,51,120,224,207,212,211,211,211,212,212,211,211,212,211,212,205,228,155,59,78,35,50,65,72,39,59,29,71,41,38,47,50,46,48,2,113,254,254,254,254,248,255,162,4,29,51,47,75,75,49,212,205,205,210,212,210,211,211,211,211,212,211,211,208,224,158,67,32,94,60,72,52,2,69,160,93,38,52,46,23,35,56,1,147,254,254,254,253,251,255,102,5,49,46,38,77,45,32,225,229,229,215,210,212,212,211,212,211,212,212,212,209,217,199,37,78,198,73,57,116,173,203,196,44,49,15,72,19,19,23,0,165,254,254,254,252,255,242,69,13,55,44,44,42,49,182,161,87,100,201,216,210,212,212,210,211,210,212,211,211,213,219,116,183,126,21,122,213,223,229,172,43,69,19,70,23,46,19,0,189,254,254,254,251,255,219,45,18,52,42,70,6,78,114,153,130,147,203,214,211,212,212,212,212,212,212,212,212,212,211,208,228,102,140,217,213,208,216,160,40,84,70,78,46,70,22,0,235,254,254,253,255,239,114,2,26,51,42,75,45,130,191,219,222,219,211,211,211,212,212,210,212,212,212,212,211,210,210,213,212,211,219,216,214,215,219,193,60,56,82,75,74,84,14,26,244,254,253,255,245,95,7,17,1,54,82,71,89,240,210,181,186,215,217,209,211,210,210,211,211,216,214,211,213,221,222,218,218,218,212,210,204,200,210,227,185,62,41,32,58,84,12,33,243,254,254,252,126,9,138,183,105,30,73,39,92,198,71,31,5,92,210,214,215,218,217,221,220,195,203,214,210,180,165,145,136,128,84,74,76,38,82,165,226,111,33,51,37,46,5,69,247,253,255,227,25,64,120,125,216,32,49,59,62,60,37,35,60,38,92,158,190,196,196,184,189,79,166,230,154,0,6,9,23,37,25,32,42,36,24,35,97,111,27,49,45,52,3,79,245,253,255,233,46,55,123,23,163,65,50,46,7,87,121,86,81,59,20,26,60,63,65,18,63,104,156,237,135,11,58,78,51,56,81,123,132,129,91,24,6,75,39,46,43,47,0,106,255,253,255,240,68,34,138,66,113,86,75,0,125,252,239,248,235,194,152,110,67,23,35,12,121,178,64,207,212,110,81,115,138,187,227,233,223,225,222,111,71,99,40,45,48,66,13,43,195,253,255,246,111,0,90,135,44,67,70,28,104,179,139,141,137,146,145,134,139,133,54,59,217,141,83,158,175,87,223,255,217,167,155,189,227,216,210,222,200,110,17,49,77,79,0,0,27,254,252,255,176,2,131,137,0,64,50,149,57,15,0,0,3,58,108,98,76,165,107,75,234,107,119,187,62,143,195,157,126,72,75,104,108,176,211,209,218,81,2,90,69,38,75,77,1,254,251,255,181,0,125,132,35,26,30,200,169,39,50,42,11,71,149,167,146,80,33,92,220,198,180,142,87,180,39,10,56,105,78,115,107,100,206,220,212,103,50,55,39,183,199,161,6,254,251,255,183,0,114,133,83,30,40,198,219,187,147,149,135,129,142,152,142,86,49,149,217,218,176,175,191,18,13,13,66,215,210,199,137,93,159,91,185,74,48,29,158,156,59,167,50,254,253,255,154,0,100,114,74,146,188,211,211,215,153,122,112,128,95,94,70,105,110,60,204,218,140,115,93,0,27,0,5,153,246,255,238,117,64,202,201,57,28,105,150,66,52,209,31,254,254,255,146,0,121,187,85,175,229,209,211,210,208,201,198,200,181,173,184,223,76,111,213,215,125,84,52,73,153,135,120,96,62,100,113,93,142,177,118,38,60,103,71,195,125,133,9,254,254,255,152,0,103,237,207,214,217,213,212,212,213,215,215,214,216,213,223,191,87,197,220,209,76,123,227,118,110,157,161,150,139,171,180,188,211,190,102,0,117,106,40,204,127,44,1,254,254,255,154,0,92,236,151,139,152,208,215,212,212,211,210,211,212,206,222,155,78,200,219,209,73,114,232,214,205,179,117,94,102,97,206,220,218,202,42,62,168,98,72,175,83,0,47,254,251,255,190,0,92,194,61,108,98,197,216,211,212,211,210,212,209,207,229,130,76,203,218,209,85,122,225,207,212,216,220,220,220,220,212,211,214,207,152,221,117,38,179,146,21,0,178,253,252,255,226,48,25,51,57,194,98,188,218,211,212,211,211,209,219,221,221,186,167,210,214,209,118,177,221,208,212,211,210,209,209,209,210,209,210,210,226,210,61,65,245,143,6,17,245,255,253,254,255,191,35,0,104,234,77,155,218,212,212,210,212,223,203,117,133,218,218,209,213,208,98,173,220,214,210,211,211,212,211,212,211,216,213,209,198,215,115,82,233,142,0,132,253,249,252,249,250,255,147,2,123,240,115,134,216,211,211,214,213,152,56,22,129,211,210,212,212,214,186,133,97,182,223,206,213,212,211,211,216,209,213,199,137,233,179,116,243,89,18,212,255,166,255,255,245,252,172,0,117,240,106,83,212,213,210,221,139,54,77,170,255,214,210,211,212,209,218,146,0,71,224,211,210,213,211,214,201,90,203,165,75,240,183,219,188,13,147,255,253,33,101,168,255,254,168,0,118,236,136,129,211,210,223,183,57,185,164,98,182,196,215,205,204,211,234,249,103,67,179,206,211,211,209,221,93,118,229,118,10,171,251,193,39,60,247,254,252,0,0,11,119,255,165,0,123,231,203,213,212,213,211,102,123,240,185,116,141,81,156,246,229,215,137,104,87,174,146,161,230,207,216,191,64,226,210,51,0,47,120,35,6,188,254,253,254,40,125,7,15,223,189,1,98,219,217,211,212,219,189,79,204,211,210,210,206,164,77,124,136,74,56,52,136,232,145,116,220,210,223,118,135,223,178,3,8,7,0,0,133,247,255,252,254,91,174,59,5,146,231,20,84,217,212,211,212,212,207,191,212,210,219,223,221,235,71,57,12,134,222,200,214,220,195,74,159,225,222,90,178,217,93,0,93,213,176,216,245,254,254,254,254,90,99,72,0,137,239,28,67,209,216,208,212,216,214,217,216,221,176,112,103,75,34,171,48,94,126,216,217,204,232,101,95,217,215,197,213,211,30,12,170,255,255,255,255,254,254,254,254,45,55,76,0,53,163,48,31,193,219,211,209,103,200,223,154,38,62,121,143,173,105,90,182,201,135,95,186,217,221,168,129,205,217,213,222,184,1,50,252,247,253,252,253,254,254,254,254,151,104,142,5,45,156,55,0,174,223,210,207,48,209,178,5,13,81,106,72,55,41,71,86,92,156,119,109,228,216,214,216,211,212,210,219,79,4,167,255,253,254,254,254,254,254,254,254,220,136,104,52,37,164,62,0,138,222,210,214,56,128,164,24,89,175,216,216,187,82,57,100,104,96,55,46,119,215,204,217,215,211,214,206,30,30,245,230,208,254,252,254,254,254,254,254,106,119,86,0,37,141,54,0,99,216,212,216,167,82,209,222,132,34,143,218,215,236,234,228,228,231,217,106,0,83,230,148,169,220,218,143,0,131,251,138,141,255,249,254,254,254,254,254,47,20,23,36,9,32,7,3,39,188,219,208,220,223,198,207,239,173,60,116,140,152,175,187,178,134,126,93,73,138,194,49,150,223,226,80,14,220,235,113,180,235,251,253,254,254,254,254,243,171,120,157,0,3,23,59,62,77,211,215,207,208,213,211,204,154,60,33,60,54,61,27,60,74,28,73,230,188,58,147,221,214,185,30,78,255,199,141,137,168,255,250,254,254,254,254,225,216,123,62,5,49,92,96,112,0,95,230,209,210,209,224,173,79,152,206,201,187,158,80,56,162,207,207,217,186,183,213,212,221,57,0,191,244,150,121,117,220,252,252,254,254,254,254,79,87,59,0,55,95,89,89,86,32,26,150,228,209,212,213,205,216,228,216,215,218,227,232,136,55,229,210,209,218,218,210,217,92,0,1,166,255,236,188,182,255,250,254,254,254,254,254,18,0,0,73,92,90,85,100,64,74,196,46,143,216,210,211,214,213,207,207,208,209,207,212,208,152,212,209,213,206,209,220,91,15,34,2,15,85,187,255,255,253,251,252,254,254,254,254,92,59,75,104,92,91,87,105,17,146,255,163,46,221,211,211,210,211,210,223,221,211,212,211,211,226,211,212,206,217,215,90,0,77,71,0,30,0,14,76,176,228,255,255,250,253,254,254,66,86,99,85,59,79,99,81,26,176,245,255,133,86,234,205,213,205,231,118,122,215,213,211,211,208,210,209,226,185,138,63,36,100,90,37,89,77,38,9,10,34,77,199,255,255,252,254,84,92,92,75,54,92,96,83,5,187,231,223,243,95,130,227,206,207,229,141,150,219,211,209,213,215,211,223,155,115,189,91,44,93,99,61,67,101,92,92,60,6,0,17,76,236,255,255,93,90,85,50,62,95,95,81,25,202,199,58,245,232,63,143,241,205,211,214,214,211,210,210,212,220,212,128,129,200,181,123,56,89,95,86,48,90,90,92,99,84,22,0,0,42,129,180]])


		for idx, face in enumerate(faces):
		 	emotion=6
            emotion=self.pickle_model.predict([[254,254,254,254,254,249,255,160,2,58,53,70,77,76,75,78,68,18,32,29,0,54,73,75,72,68,75,77,76,76,75,80,51,36,47,40,44,42,37,48,40,64,54,54,86,16,0,161,254,254,254,254,254,248,255,120,2,38,50,47,76,76,83,63,51,142,174,159,88,59,48,67,37,61,46,77,77,75,74,85,19,54,81,73,50,49,53,72,45,41,66,53,70,17,0,122,254,254,254,254,253,253,250,61,17,52,34,34,76,79,68,50,129,235,214,219,226,215,183,116,127,218,93,43,79,80,74,79,57,40,73,30,77,64,49,83,65,38,70,57,72,26,0,114,254,254,254,254,252,255,231,53,17,61,8,2,76,61,21,125,226,207,208,209,206,213,217,226,224,218,214,96,36,67,79,78,51,37,76,7,71,37,51,82,56,59,84,79,82,59,2,74,254,254,254,254,252,255,223,47,16,83,59,54,77,37,127,226,208,211,210,211,212,210,209,207,206,207,216,216,80,24,80,76,64,54,66,3,68,22,58,54,40,83,61,64,65,52,2,96,254,254,254,254,250,255,185,19,25,62,77,80,48,83,228,208,210,213,212,210,211,212,213,213,211,213,208,215,216,88,47,86,69,82,45,18,80,36,38,2,34,53,39,41,40,48,2,124,254,254,254,254,250,255,173,11,30,45,74,75,51,120,224,207,212,211,211,211,212,212,211,211,212,211,212,205,228,155,59,78,35,50,65,72,39,59,29,71,41,38,47,50,46,48,2,113,254,254,254,254,248,255,162,4,29,51,47,75,75,49,212,205,205,210,212,210,211,211,211,211,212,211,211,208,224,158,67,32,94,60,72,52,2,69,160,93,38,52,46,23,35,56,1,147,254,254,254,253,251,255,102,5,49,46,38,77,45,32,225,229,229,215,210,212,212,211,212,211,212,212,212,209,217,199,37,78,198,73,57,116,173,203,196,44,49,15,72,19,19,23,0,165,254,254,254,252,255,242,69,13,55,44,44,42,49,182,161,87,100,201,216,210,212,212,210,211,210,212,211,211,213,219,116,183,126,21,122,213,223,229,172,43,69,19,70,23,46,19,0,189,254,254,254,251,255,219,45,18,52,42,70,6,78,114,153,130,147,203,214,211,212,212,212,212,212,212,212,212,212,211,208,228,102,140,217,213,208,216,160,40,84,70,78,46,70,22,0,235,254,254,253,255,239,114,2,26,51,42,75,45,130,191,219,222,219,211,211,211,212,212,210,212,212,212,212,211,210,210,213,212,211,219,216,214,215,219,193,60,56,82,75,74,84,14,26,244,254,253,255,245,95,7,17,1,54,82,71,89,240,210,181,186,215,217,209,211,210,210,211,211,216,214,211,213,221,222,218,218,218,212,210,204,200,210,227,185,62,41,32,58,84,12,33,243,254,254,252,126,9,138,183,105,30,73,39,92,198,71,31,5,92,210,214,215,218,217,221,220,195,203,214,210,180,165,145,136,128,84,74,76,38,82,165,226,111,33,51,37,46,5,69,247,253,255,227,25,64,120,125,216,32,49,59,62,60,37,35,60,38,92,158,190,196,196,184,189,79,166,230,154,0,6,9,23,37,25,32,42,36,24,35,97,111,27,49,45,52,3,79,245,253,255,233,46,55,123,23,163,65,50,46,7,87,121,86,81,59,20,26,60,63,65,18,63,104,156,237,135,11,58,78,51,56,81,123,132,129,91,24,6,75,39,46,43,47,0,106,255,253,255,240,68,34,138,66,113,86,75,0,125,252,239,248,235,194,152,110,67,23,35,12,121,178,64,207,212,110,81,115,138,187,227,233,223,225,222,111,71,99,40,45,48,66,13,43,195,253,255,246,111,0,90,135,44,67,70,28,104,179,139,141,137,146,145,134,139,133,54,59,217,141,83,158,175,87,223,255,217,167,155,189,227,216,210,222,200,110,17,49,77,79,0,0,27,254,252,255,176,2,131,137,0,64,50,149,57,15,0,0,3,58,108,98,76,165,107,75,234,107,119,187,62,143,195,157,126,72,75,104,108,176,211,209,218,81,2,90,69,38,75,77,1,254,251,255,181,0,125,132,35,26,30,200,169,39,50,42,11,71,149,167,146,80,33,92,220,198,180,142,87,180,39,10,56,105,78,115,107,100,206,220,212,103,50,55,39,183,199,161,6,254,251,255,183,0,114,133,83,30,40,198,219,187,147,149,135,129,142,152,142,86,49,149,217,218,176,175,191,18,13,13,66,215,210,199,137,93,159,91,185,74,48,29,158,156,59,167,50,254,253,255,154,0,100,114,74,146,188,211,211,215,153,122,112,128,95,94,70,105,110,60,204,218,140,115,93,0,27,0,5,153,246,255,238,117,64,202,201,57,28,105,150,66,52,209,31,254,254,255,146,0,121,187,85,175,229,209,211,210,208,201,198,200,181,173,184,223,76,111,213,215,125,84,52,73,153,135,120,96,62,100,113,93,142,177,118,38,60,103,71,195,125,133,9,254,254,255,152,0,103,237,207,214,217,213,212,212,213,215,215,214,216,213,223,191,87,197,220,209,76,123,227,118,110,157,161,150,139,171,180,188,211,190,102,0,117,106,40,204,127,44,1,254,254,255,154,0,92,236,151,139,152,208,215,212,212,211,210,211,212,206,222,155,78,200,219,209,73,114,232,214,205,179,117,94,102,97,206,220,218,202,42,62,168,98,72,175,83,0,47,254,251,255,190,0,92,194,61,108,98,197,216,211,212,211,210,212,209,207,229,130,76,203,218,209,85,122,225,207,212,216,220,220,220,220,212,211,214,207,152,221,117,38,179,146,21,0,178,253,252,255,226,48,25,51,57,194,98,188,218,211,212,211,211,209,219,221,221,186,167,210,214,209,118,177,221,208,212,211,210,209,209,209,210,209,210,210,226,210,61,65,245,143,6,17,245,255,253,254,255,191,35,0,104,234,77,155,218,212,212,210,212,223,203,117,133,218,218,209,213,208,98,173,220,214,210,211,211,212,211,212,211,216,213,209,198,215,115,82,233,142,0,132,253,249,252,249,250,255,147,2,123,240,115,134,216,211,211,214,213,152,56,22,129,211,210,212,212,214,186,133,97,182,223,206,213,212,211,211,216,209,213,199,137,233,179,116,243,89,18,212,255,166,255,255,245,252,172,0,117,240,106,83,212,213,210,221,139,54,77,170,255,214,210,211,212,209,218,146,0,71,224,211,210,213,211,214,201,90,203,165,75,240,183,219,188,13,147,255,253,33,101,168,255,254,168,0,118,236,136,129,211,210,223,183,57,185,164,98,182,196,215,205,204,211,234,249,103,67,179,206,211,211,209,221,93,118,229,118,10,171,251,193,39,60,247,254,252,0,0,11,119,255,165,0,123,231,203,213,212,213,211,102,123,240,185,116,141,81,156,246,229,215,137,104,87,174,146,161,230,207,216,191,64,226,210,51,0,47,120,35,6,188,254,253,254,40,125,7,15,223,189,1,98,219,217,211,212,219,189,79,204,211,210,210,206,164,77,124,136,74,56,52,136,232,145,116,220,210,223,118,135,223,178,3,8,7,0,0,133,247,255,252,254,91,174,59,5,146,231,20,84,217,212,211,212,212,207,191,212,210,219,223,221,235,71,57,12,134,222,200,214,220,195,74,159,225,222,90,178,217,93,0,93,213,176,216,245,254,254,254,254,90,99,72,0,137,239,28,67,209,216,208,212,216,214,217,216,221,176,112,103,75,34,171,48,94,126,216,217,204,232,101,95,217,215,197,213,211,30,12,170,255,255,255,255,254,254,254,254,45,55,76,0,53,163,48,31,193,219,211,209,103,200,223,154,38,62,121,143,173,105,90,182,201,135,95,186,217,221,168,129,205,217,213,222,184,1,50,252,247,253,252,253,254,254,254,254,151,104,142,5,45,156,55,0,174,223,210,207,48,209,178,5,13,81,106,72,55,41,71,86,92,156,119,109,228,216,214,216,211,212,210,219,79,4,167,255,253,254,254,254,254,254,254,254,220,136,104,52,37,164,62,0,138,222,210,214,56,128,164,24,89,175,216,216,187,82,57,100,104,96,55,46,119,215,204,217,215,211,214,206,30,30,245,230,208,254,252,254,254,254,254,254,106,119,86,0,37,141,54,0,99,216,212,216,167,82,209,222,132,34,143,218,215,236,234,228,228,231,217,106,0,83,230,148,169,220,218,143,0,131,251,138,141,255,249,254,254,254,254,254,47,20,23,36,9,32,7,3,39,188,219,208,220,223,198,207,239,173,60,116,140,152,175,187,178,134,126,93,73,138,194,49,150,223,226,80,14,220,235,113,180,235,251,253,254,254,254,254,243,171,120,157,0,3,23,59,62,77,211,215,207,208,213,211,204,154,60,33,60,54,61,27,60,74,28,73,230,188,58,147,221,214,185,30,78,255,199,141,137,168,255,250,254,254,254,254,225,216,123,62,5,49,92,96,112,0,95,230,209,210,209,224,173,79,152,206,201,187,158,80,56,162,207,207,217,186,183,213,212,221,57,0,191,244,150,121,117,220,252,252,254,254,254,254,79,87,59,0,55,95,89,89,86,32,26,150,228,209,212,213,205,216,228,216,215,218,227,232,136,55,229,210,209,218,218,210,217,92,0,1,166,255,236,188,182,255,250,254,254,254,254,254,18,0,0,73,92,90,85,100,64,74,196,46,143,216,210,211,214,213,207,207,208,209,207,212,208,152,212,209,213,206,209,220,91,15,34,2,15,85,187,255,255,253,251,252,254,254,254,254,92,59,75,104,92,91,87,105,17,146,255,163,46,221,211,211,210,211,210,223,221,211,212,211,211,226,211,212,206,217,215,90,0,77,71,0,30,0,14,76,176,228,255,255,250,253,254,254,66,86,99,85,59,79,99,81,26,176,245,255,133,86,234,205,213,205,231,118,122,215,213,211,211,208,210,209,226,185,138,63,36,100,90,37,89,77,38,9,10,34,77,199,255,255,252,254,84,92,92,75,54,92,96,83,5,187,231,223,243,95,130,227,206,207,229,141,150,219,211,209,213,215,211,223,155,115,189,91,44,93,99,61,67,101,92,92,60,6,0,17,76,236,255,255,93,90,85,50,62,95,95,81,25,202,199,58,245,232,63,143,241,205,211,214,214,211,210,210,212,220,212,128,129,200,181,123,56,89,95,86,48,90,90,92,99,84,22,0,0,42,129,180]])
		 	
            self.faces.set_expression(idx,expression=emotions[emotion[idx]])

